
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>Codis简单使用 - Winse Blog</title>
  <meta name="author" content="Winse Liu">

  
  <meta name="description" content="总有单机搞不定的时刻，并且手动切分很麻烦的时刻。不得不开始redis集群，官网的redis3不支持pipeline首先就排除了。 安装codis，需要先安装go。(官网入门文档](https://github.com/CodisLabs/codis/blob/master/doc/ &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://winseliu.com/blog/2016/07/14/codis-guide">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <link href="http://maxcdn.bootstrapcdn.com/font-awesome/4.1.0/css/font-awesome.min.css" rel="stylesheet">
  <link href="/atom.xml" rel="alternate" title="Winse Blog" type="application/atom+xml">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="http://cdn.bootcss.com/jquery/1.9.1/jquery.min.js"></script>
  <script>!window.jQuery && document.write(unescape('%3Cscript src="/javascripts/libs/jquery.min.js"%3E%3C/script%3E'))</script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<!--
<link href="//fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="//fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
-->


  
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-43198550-1', 'auto');
  ga('send', 'pageview');

</script>



</head>

<body   >
  <header role="banner"><hgroup>
  <h1><a href="/">Winse Blog</a></h1>
  
    <h2>走走停停, 熙熙攘攘, 忙忙碌碌, 不知何畏.</h2>
  
</hgroup>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
  
<form action="https://www.google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="q" value="site:winseliu.com" />
    <input class="search" type="text" name="q" results="0" placeholder="站内搜索"/>
  </fieldset>
</form>
  
<ul class="main-navigation">
  <li><a href="/">Blog</a></li>
  <li><a href="/blog/archives">Archives</a></li>
  <li><a href="/blog/archives/updated.html">Updated</a></li>
  <li><a href="https://yunpan.cn/cuYhpFBPgQYgT" >Books[5aee]</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div>
<article class="hentry" role="article">
  
  <header>
    
      <h1 class="entry-title">Codis简单使用</h1>
    
    
      <p class="meta">
        








  


<time datetime="2016-07-14T19:35:23+08:00" pubdate data-updated="true">Thu 2016-07-14 19:35</time>
        
      </p>
    
  </header>


<div class="entry-content"><p>总有单机搞不定的时刻，并且手动切分很麻烦的时刻。不得不开始redis集群，官网的redis3不支持pipeline首先就排除了。</p>

<p>安装codis，需要先安装go。(官网入门文档](<a href="https://github.com/CodisLabs/codis/blob/master/doc/tutorial_zh.md">https://github.com/CodisLabs/codis/blob/master/doc/tutorial_zh.md</a>)</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>[root@cu2 local]# tar zxvf go1.6.2.linux-amd64.tar.gz 
</span><span class='line'>
</span><span class='line'>[hadoop@cu2 ~]$ vi .bash_profile
</span><span class='line'>...
</span><span class='line'>export GOROOT=/usr/local/go
</span><span class='line'>export GOPATH=$HOME/codis
</span><span class='line'>
</span><span class='line'>PATH=$GOPATH/bin:$GOROOT/bin:$HOME/bin:$HADOOP_HOME/bin:$HIVE_HOME/bin:$PATH
</span><span class='line'>
</span><span class='line'>[hadoop@cu2 codis]$ source ~/.bash_profile </span></code></pre></td></tr></table></div></figure>


<p>git,make 这些要提前安装好。测试环境都编译过hadoop、spark肯定齐全的。</p>

<p>通过go在线安装（如果生产不能上网，可以先在测试环境安装好后，然后打包复制过去）：</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
<span class='line-number'>48</span>
<span class='line-number'>49</span>
<span class='line-number'>50</span>
<span class='line-number'>51</span>
<span class='line-number'>52</span>
<span class='line-number'>53</span>
<span class='line-number'>54</span>
<span class='line-number'>55</span>
<span class='line-number'>56</span>
<span class='line-number'>57</span>
<span class='line-number'>58</span>
<span class='line-number'>59</span>
<span class='line-number'>60</span>
<span class='line-number'>61</span>
<span class='line-number'>62</span>
<span class='line-number'>63</span>
<span class='line-number'>64</span>
<span class='line-number'>65</span>
<span class='line-number'>66</span>
<span class='line-number'>67</span>
<span class='line-number'>68</span>
<span class='line-number'>69</span>
<span class='line-number'>70</span>
<span class='line-number'>71</span>
<span class='line-number'>72</span>
<span class='line-number'>73</span>
<span class='line-number'>74</span>
<span class='line-number'>75</span>
<span class='line-number'>76</span>
<span class='line-number'>77</span>
<span class='line-number'>78</span>
<span class='line-number'>79</span>
<span class='line-number'>80</span>
<span class='line-number'>81</span>
<span class='line-number'>82</span>
<span class='line-number'>83</span>
<span class='line-number'>84</span>
<span class='line-number'>85</span>
<span class='line-number'>86</span>
<span class='line-number'>87</span>
<span class='line-number'>88</span>
<span class='line-number'>89</span>
<span class='line-number'>90</span>
<span class='line-number'>91</span>
<span class='line-number'>92</span>
<span class='line-number'>93</span>
<span class='line-number'>94</span>
<span class='line-number'>95</span>
<span class='line-number'>96</span>
<span class='line-number'>97</span>
<span class='line-number'>98</span>
<span class='line-number'>99</span>
<span class='line-number'>100</span>
<span class='line-number'>101</span>
<span class='line-number'>102</span>
<span class='line-number'>103</span>
<span class='line-number'>104</span>
<span class='line-number'>105</span>
<span class='line-number'>106</span>
<span class='line-number'>107</span>
<span class='line-number'>108</span>
<span class='line-number'>109</span>
<span class='line-number'>110</span>
<span class='line-number'>111</span>
<span class='line-number'>112</span>
<span class='line-number'>113</span>
<span class='line-number'>114</span>
<span class='line-number'>115</span>
<span class='line-number'>116</span>
<span class='line-number'>117</span>
<span class='line-number'>118</span>
<span class='line-number'>119</span>
<span class='line-number'>120</span>
<span class='line-number'>121</span>
<span class='line-number'>122</span>
<span class='line-number'>123</span>
<span class='line-number'>124</span>
<span class='line-number'>125</span>
<span class='line-number'>126</span>
<span class='line-number'>127</span>
<span class='line-number'>128</span>
<span class='line-number'>129</span>
<span class='line-number'>130</span>
<span class='line-number'>131</span>
<span class='line-number'>132</span>
<span class='line-number'>133</span>
<span class='line-number'>134</span>
<span class='line-number'>135</span>
<span class='line-number'>136</span>
<span class='line-number'>137</span>
<span class='line-number'>138</span>
<span class='line-number'>139</span>
<span class='line-number'>140</span>
<span class='line-number'>141</span>
<span class='line-number'>142</span>
<span class='line-number'>143</span>
<span class='line-number'>144</span>
<span class='line-number'>145</span>
<span class='line-number'>146</span>
<span class='line-number'>147</span>
<span class='line-number'>148</span>
<span class='line-number'>149</span>
<span class='line-number'>150</span>
<span class='line-number'>151</span>
<span class='line-number'>152</span>
<span class='line-number'>153</span>
<span class='line-number'>154</span>
<span class='line-number'>155</span>
<span class='line-number'>156</span>
<span class='line-number'>157</span>
<span class='line-number'>158</span>
<span class='line-number'>159</span>
<span class='line-number'>160</span>
<span class='line-number'>161</span>
<span class='line-number'>162</span>
<span class='line-number'>163</span>
<span class='line-number'>164</span>
<span class='line-number'>165</span>
<span class='line-number'>166</span>
<span class='line-number'>167</span>
<span class='line-number'>168</span>
<span class='line-number'>169</span>
<span class='line-number'>170</span>
<span class='line-number'>171</span>
<span class='line-number'>172</span>
<span class='line-number'>173</span>
<span class='line-number'>174</span>
<span class='line-number'>175</span>
<span class='line-number'>176</span>
<span class='line-number'>177</span>
<span class='line-number'>178</span>
<span class='line-number'>179</span>
<span class='line-number'>180</span>
<span class='line-number'>181</span>
<span class='line-number'>182</span>
<span class='line-number'>183</span>
<span class='line-number'>184</span>
<span class='line-number'>185</span>
<span class='line-number'>186</span>
<span class='line-number'>187</span>
<span class='line-number'>188</span>
<span class='line-number'>189</span>
<span class='line-number'>190</span>
<span class='line-number'>191</span>
<span class='line-number'>192</span>
<span class='line-number'>193</span>
<span class='line-number'>194</span>
<span class='line-number'>195</span>
<span class='line-number'>196</span>
<span class='line-number'>197</span>
<span class='line-number'>198</span>
<span class='line-number'>199</span>
<span class='line-number'>200</span>
<span class='line-number'>201</span>
<span class='line-number'>202</span>
<span class='line-number'>203</span>
<span class='line-number'>204</span>
<span class='line-number'>205</span>
<span class='line-number'>206</span>
<span class='line-number'>207</span>
<span class='line-number'>208</span>
<span class='line-number'>209</span>
<span class='line-number'>210</span>
<span class='line-number'>211</span>
<span class='line-number'>212</span>
<span class='line-number'>213</span>
<span class='line-number'>214</span>
<span class='line-number'>215</span>
<span class='line-number'>216</span>
<span class='line-number'>217</span>
<span class='line-number'>218</span>
<span class='line-number'>219</span>
<span class='line-number'>220</span>
<span class='line-number'>221</span>
<span class='line-number'>222</span>
<span class='line-number'>223</span>
<span class='line-number'>224</span>
<span class='line-number'>225</span>
<span class='line-number'>226</span>
<span class='line-number'>227</span>
<span class='line-number'>228</span>
<span class='line-number'>229</span>
<span class='line-number'>230</span>
<span class='line-number'>231</span>
<span class='line-number'>232</span>
<span class='line-number'>233</span>
<span class='line-number'>234</span>
<span class='line-number'>235</span>
<span class='line-number'>236</span>
<span class='line-number'>237</span>
<span class='line-number'>238</span>
<span class='line-number'>239</span>
<span class='line-number'>240</span>
<span class='line-number'>241</span>
<span class='line-number'>242</span>
<span class='line-number'>243</span>
<span class='line-number'>244</span>
<span class='line-number'>245</span>
<span class='line-number'>246</span>
<span class='line-number'>247</span>
<span class='line-number'>248</span>
<span class='line-number'>249</span>
<span class='line-number'>250</span>
<span class='line-number'>251</span>
<span class='line-number'>252</span>
<span class='line-number'>253</span>
<span class='line-number'>254</span>
<span class='line-number'>255</span>
<span class='line-number'>256</span>
<span class='line-number'>257</span>
<span class='line-number'>258</span>
<span class='line-number'>259</span>
<span class='line-number'>260</span>
<span class='line-number'>261</span>
<span class='line-number'>262</span>
<span class='line-number'>263</span>
<span class='line-number'>264</span>
<span class='line-number'>265</span>
<span class='line-number'>266</span>
<span class='line-number'>267</span>
<span class='line-number'>268</span>
<span class='line-number'>269</span>
<span class='line-number'>270</span>
<span class='line-number'>271</span>
<span class='line-number'>272</span>
<span class='line-number'>273</span>
<span class='line-number'>274</span>
<span class='line-number'>275</span>
<span class='line-number'>276</span>
<span class='line-number'>277</span>
<span class='line-number'>278</span>
<span class='line-number'>279</span>
<span class='line-number'>280</span>
<span class='line-number'>281</span>
<span class='line-number'>282</span>
<span class='line-number'>283</span>
<span class='line-number'>284</span>
<span class='line-number'>285</span>
<span class='line-number'>286</span>
<span class='line-number'>287</span>
<span class='line-number'>288</span>
<span class='line-number'>289</span>
<span class='line-number'>290</span>
<span class='line-number'>291</span>
<span class='line-number'>292</span>
<span class='line-number'>293</span>
<span class='line-number'>294</span>
<span class='line-number'>295</span>
<span class='line-number'>296</span>
<span class='line-number'>297</span>
<span class='line-number'>298</span>
<span class='line-number'>299</span>
<span class='line-number'>300</span>
<span class='line-number'>301</span>
<span class='line-number'>302</span>
<span class='line-number'>303</span>
<span class='line-number'>304</span>
<span class='line-number'>305</span>
<span class='line-number'>306</span>
<span class='line-number'>307</span>
<span class='line-number'>308</span>
<span class='line-number'>309</span>
<span class='line-number'>310</span>
<span class='line-number'>311</span>
<span class='line-number'>312</span>
<span class='line-number'>313</span>
<span class='line-number'>314</span>
<span class='line-number'>315</span>
<span class='line-number'>316</span>
<span class='line-number'>317</span>
<span class='line-number'>318</span>
<span class='line-number'>319</span>
<span class='line-number'>320</span>
<span class='line-number'>321</span>
<span class='line-number'>322</span>
<span class='line-number'>323</span>
<span class='line-number'>324</span>
<span class='line-number'>325</span>
<span class='line-number'>326</span>
<span class='line-number'>327</span>
<span class='line-number'>328</span>
<span class='line-number'>329</span>
<span class='line-number'>330</span>
<span class='line-number'>331</span>
<span class='line-number'>332</span>
<span class='line-number'>333</span>
<span class='line-number'>334</span>
<span class='line-number'>335</span>
<span class='line-number'>336</span>
<span class='line-number'>337</span>
<span class='line-number'>338</span>
<span class='line-number'>339</span>
<span class='line-number'>340</span>
<span class='line-number'>341</span>
<span class='line-number'>342</span>
<span class='line-number'>343</span>
<span class='line-number'>344</span>
<span class='line-number'>345</span>
<span class='line-number'>346</span>
<span class='line-number'>347</span>
<span class='line-number'>348</span>
<span class='line-number'>349</span>
<span class='line-number'>350</span>
<span class='line-number'>351</span>
<span class='line-number'>352</span>
<span class='line-number'>353</span>
<span class='line-number'>354</span>
<span class='line-number'>355</span>
<span class='line-number'>356</span>
<span class='line-number'>357</span>
<span class='line-number'>358</span>
<span class='line-number'>359</span>
<span class='line-number'>360</span>
<span class='line-number'>361</span>
<span class='line-number'>362</span>
<span class='line-number'>363</span>
<span class='line-number'>364</span>
<span class='line-number'>365</span>
<span class='line-number'>366</span>
<span class='line-number'>367</span>
<span class='line-number'>368</span>
<span class='line-number'>369</span>
<span class='line-number'>370</span>
<span class='line-number'>371</span>
<span class='line-number'>372</span>
<span class='line-number'>373</span>
<span class='line-number'>374</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>[hadoop@cu2 codis]$ go get -u -d github.com/CodisLabs/codis
</span><span class='line'>package github.com/CodisLabs/codis: no buildable Go source files in /home/hadoop/codis/src/github.com/CodisLabs/codis
</span><span class='line'>[hadoop@cu2 codis]$ 
</span><span class='line'>
</span><span class='line'>&lt;&lt;安装依赖的工具
</span><span class='line'>[hadoop@cu2 codis]$ go get github.com/tools/godep
</span><span class='line'>
</span><span class='line'>[hadoop@cu2 codis]$ make
</span><span class='line'>GO15VENDOREXPERIMENT=0 GOPATH=`godep path` godep restore
</span><span class='line'>godep: [WARNING]: godep should only be used inside a valid go package directory and
</span><span class='line'>godep: [WARNING]: may not function correctly. You are probably outside of your $GOPATH.
</span><span class='line'>godep: [WARNING]:       Current Directory: /home/hadoop/codis/src/github.com/CodisLabs/codis
</span><span class='line'>godep: [WARNING]:       $GOPATH: /home/hadoop/codis/src/github.com/CodisLabs/codis/Godeps/_workspace
</span><span class='line'>       
</span><span class='line'>&lt;&lt;这里要等一段时间
</span><span class='line'>
</span><span class='line'>GOPATH=`godep path`:$GOPATH go build -o bin/codis-proxy ./cmd/proxy
</span><span class='line'>godep: WARNING: Godep workspaces (./Godeps/_workspace) are deprecated and support for them will be removed when go1.8 is released.
</span><span class='line'>godep: WARNING: Go version (go1.6) & $GO15VENDOREXPERIMENT= wants to enable the vendor experiment, but disabling because a Godep workspace (Godeps/_workspace) exists
</span><span class='line'>GOPATH=`godep path`:$GOPATH go build -o bin/codis-config ./cmd/cconfig
</span><span class='line'>godep: WARNING: Godep workspaces (./Godeps/_workspace) are deprecated and support for them will be removed when go1.8 is released.
</span><span class='line'>godep: WARNING: Go version (go1.6) & $GO15VENDOREXPERIMENT= wants to enable the vendor experiment, but disabling because a Godep workspace (Godeps/_workspace) exists
</span><span class='line'>make -j4 -C extern/redis-2.8.21/
</span><span class='line'>make[1]: Entering directory `/home/hadoop/codis/src/github.com/CodisLabs/codis/extern/redis-2.8.21'
</span><span class='line'>cd src && make all
</span><span class='line'>make[2]: Entering directory `/home/hadoop/codis/src/github.com/CodisLabs/codis/extern/redis-2.8.21/src'
</span><span class='line'>rm -rf redis-server redis-sentinel redis-cli redis-benchmark redis-check-dump redis-check-aof *.o *.gcda *.gcno *.gcov redis.info lcov-html
</span><span class='line'>(cd ../deps && make distclean)
</span><span class='line'>make[3]: Entering directory `/home/hadoop/codis/src/github.com/CodisLabs/codis/extern/redis-2.8.21/deps'
</span><span class='line'>(cd hiredis && make clean) &gt; /dev/null || true
</span><span class='line'>(cd linenoise && make clean) &gt; /dev/null || true
</span><span class='line'>(cd lua && make clean) &gt; /dev/null || true
</span><span class='line'>(cd jemalloc && [ -f Makefile ] && make distclean) &gt; /dev/null || true
</span><span class='line'>(rm -f .make-*)
</span><span class='line'>make[3]: Leaving directory `/home/hadoop/codis/src/github.com/CodisLabs/codis/extern/redis-2.8.21/deps'
</span><span class='line'>(rm -f .make-*)
</span><span class='line'>echo STD=-std=c99 -pedantic &gt;&gt; .make-settings
</span><span class='line'>echo WARN=-Wall -W &gt;&gt; .make-settings
</span><span class='line'>echo OPT=-O2 &gt;&gt; .make-settings
</span><span class='line'>echo MALLOC=jemalloc &gt;&gt; .make-settings
</span><span class='line'>echo CFLAGS= &gt;&gt; .make-settings
</span><span class='line'>echo LDFLAGS= &gt;&gt; .make-settings
</span><span class='line'>echo REDIS_CFLAGS= &gt;&gt; .make-settings
</span><span class='line'>echo REDIS_LDFLAGS= &gt;&gt; .make-settings
</span><span class='line'>echo PREV_FINAL_CFLAGS=-std=c99 -pedantic -Wall -W -O2 -g -ggdb   -I../deps/hiredis -I../deps/linenoise -I../deps/lua/src -DUSE_JEMALLOC -I../deps/jemalloc/include &gt;&gt; .make-settings
</span><span class='line'>echo PREV_FINAL_LDFLAGS=  -g -ggdb -rdynamic &gt;&gt; .make-settings
</span><span class='line'>(cd ../deps && make hiredis linenoise lua jemalloc)
</span><span class='line'>make[3]: Entering directory `/home/hadoop/codis/src/github.com/CodisLabs/codis/extern/redis-2.8.21/deps'
</span><span class='line'>(cd hiredis && make clean) &gt; /dev/null || true
</span><span class='line'>(cd linenoise && make clean) &gt; /dev/null || true
</span><span class='line'>(cd lua && make clean) &gt; /dev/null || true
</span><span class='line'>(cd jemalloc && [ -f Makefile ] && make distclean) &gt; /dev/null || true
</span><span class='line'>(rm -f .make-*)
</span><span class='line'>(echo "" &gt; .make-ldflags)
</span><span class='line'>(echo "" &gt; .make-cflags)
</span><span class='line'>MAKE hiredis
</span><span class='line'>cd hiredis && make static
</span><span class='line'>MAKE linenoise
</span><span class='line'>cd linenoise && make
</span><span class='line'>MAKE lua
</span><span class='line'>cd lua/src && make all CFLAGS="-O2 -Wall -DLUA_ANSI -DENABLE_CJSON_GLOBAL " MYLDFLAGS="" AR="ar rcu"
</span><span class='line'>MAKE jemalloc
</span><span class='line'>cd jemalloc && ./configure --with-jemalloc-prefix=je_ --enable-cc-silence CFLAGS="-std=gnu99 -Wall -pipe -g3 -O3 -funroll-loops " LDFLAGS=""
</span><span class='line'>make[4]: Entering directory `/home/hadoop/codis/src/github.com/CodisLabs/codis/extern/redis-2.8.21/deps/linenoise'
</span><span class='line'>cc  -Wall -Os -g  -c linenoise.c
</span><span class='line'>make[4]: Entering directory `/home/hadoop/codis/src/github.com/CodisLabs/codis/extern/redis-2.8.21/deps/lua/src'
</span><span class='line'>cc -O2 -Wall -DLUA_ANSI -DENABLE_CJSON_GLOBAL    -c -o lapi.o lapi.c
</span><span class='line'>make[4]: Entering directory `/home/hadoop/codis/src/github.com/CodisLabs/codis/extern/redis-2.8.21/deps/hiredis'
</span><span class='line'>cc -std=c99 -pedantic -c -O3 -fPIC  -Wall -W -Wstrict-prototypes -Wwrite-strings -g -ggdb  net.c
</span><span class='line'>checking for xsltproc... /usr/bin/xsltproc
</span><span class='line'>checking for gcc... gcc
</span><span class='line'>checking whether the C compiler works... yes
</span><span class='line'>checking for C compiler default output file name... a.out
</span><span class='line'>checking for suffix of executables... 
</span><span class='line'>checking whether we are cross compiling... no
</span><span class='line'>checking for suffix of object files... o
</span><span class='line'>checking whether we are using the GNU C compiler... cc -std=c99 -pedantic -c -O3 -fPIC  -Wall -W -Wstrict-prototypes -Wwrite-strings -g -ggdb  hiredis.c
</span><span class='line'>yes
</span><span class='line'>checking whether gcc accepts -g... yes
</span><span class='line'>checking for gcc option to accept ISO C89... none needed
</span><span class='line'>checking how to run the C preprocessor... cc -O2 -Wall -DLUA_ANSI -DENABLE_CJSON_GLOBAL    -c -o lcode.o lcode.c
</span><span class='line'>make[4]: Leaving directory `/home/hadoop/codis/src/github.com/CodisLabs/codis/extern/redis-2.8.21/deps/linenoise'
</span><span class='line'>cc -O2 -Wall -DLUA_ANSI -DENABLE_CJSON_GLOBAL    -c -o ldebug.o ldebug.c
</span><span class='line'>gcc -E
</span><span class='line'>checking for grep that handles long lines and -e... /bin/grep
</span><span class='line'>checking for egrep... /bin/grep -E
</span><span class='line'>checking for ANSI C header files... yes
</span><span class='line'>checking for sys/types.h... yes
</span><span class='line'>checking for sys/stat.h... cc -O2 -Wall -DLUA_ANSI -DENABLE_CJSON_GLOBAL    -c -o ldo.o ldo.c
</span><span class='line'>yes
</span><span class='line'>cc -O2 -Wall -DLUA_ANSI -DENABLE_CJSON_GLOBAL    -c -o ldump.o ldump.c
</span><span class='line'>checking for stdlib.h... ldo.c: In function ‘f_parser’:
</span><span class='line'>ldo.c:496: warning: unused variable ‘c’
</span><span class='line'>yes
</span><span class='line'>checking for string.h... cc -O2 -Wall -DLUA_ANSI -DENABLE_CJSON_GLOBAL    -c -o lfunc.o lfunc.c
</span><span class='line'>yes
</span><span class='line'>checking for memory.h... yes
</span><span class='line'>checking for strings.h... cc -O2 -Wall -DLUA_ANSI -DENABLE_CJSON_GLOBAL    -c -o lgc.o lgc.c
</span><span class='line'>cc -O2 -Wall -DLUA_ANSI -DENABLE_CJSON_GLOBAL    -c -o llex.o llex.c
</span><span class='line'>yes
</span><span class='line'>cc -std=c99 -pedantic -c -O3 -fPIC  -Wall -W -Wstrict-prototypes -Wwrite-strings -g -ggdb  sds.c
</span><span class='line'>checking for inttypes.h... yes
</span><span class='line'>checking for stdint.h... yes
</span><span class='line'>checking for unistd.h... yes
</span><span class='line'>checking whether byte ordering is bigendian... cc -O2 -Wall -DLUA_ANSI -DENABLE_CJSON_GLOBAL    -c -o lmem.o lmem.c
</span><span class='line'>cc -O2 -Wall -DLUA_ANSI -DENABLE_CJSON_GLOBAL    -c -o lobject.o lobject.c
</span><span class='line'>no
</span><span class='line'>checking size of void *... cc -std=c99 -pedantic -c -O3 -fPIC  -Wall -W -Wstrict-prototypes -Wwrite-strings -g -ggdb  async.c
</span><span class='line'>cc -O2 -Wall -DLUA_ANSI -DENABLE_CJSON_GLOBAL    -c -o lopcodes.o lopcodes.c
</span><span class='line'>8
</span><span class='line'>checking size of int... cc -O2 -Wall -DLUA_ANSI -DENABLE_CJSON_GLOBAL    -c -o lparser.o lparser.c
</span><span class='line'>cc -O2 -Wall -DLUA_ANSI -DENABLE_CJSON_GLOBAL    -c -o lstate.o lstate.c
</span><span class='line'>4
</span><span class='line'>checking size of long... cc -O2 -Wall -DLUA_ANSI -DENABLE_CJSON_GLOBAL    -c -o lstring.o lstring.c
</span><span class='line'>8
</span><span class='line'>checking size of intmax_t... cc -O2 -Wall -DLUA_ANSI -DENABLE_CJSON_GLOBAL    -c -o ltable.o ltable.c
</span><span class='line'>8
</span><span class='line'>checking build system type... ar rcs libhiredis.a net.o hiredis.o sds.o async.o
</span><span class='line'>x86_64-unknown-linux-gnu
</span><span class='line'>checking host system type... x86_64-unknown-linux-gnu
</span><span class='line'>checking whether pause instruction is compilable... make[4]: Leaving directory `/home/hadoop/codis/src/github.com/CodisLabs/codis/extern/redis-2.8.21/deps/hiredis'
</span><span class='line'>cc -O2 -Wall -DLUA_ANSI -DENABLE_CJSON_GLOBAL    -c -o ltm.o ltm.c
</span><span class='line'>yes
</span><span class='line'>checking whether SSE2 intrinsics is compilable... cc -O2 -Wall -DLUA_ANSI -DENABLE_CJSON_GLOBAL    -c -o lundump.o lundump.c
</span><span class='line'>cc -O2 -Wall -DLUA_ANSI -DENABLE_CJSON_GLOBAL    -c -o lvm.o lvm.c
</span><span class='line'>cc -O2 -Wall -DLUA_ANSI -DENABLE_CJSON_GLOBAL    -c -o lzio.o lzio.c
</span><span class='line'>yes
</span><span class='line'>checking for ar... ar
</span><span class='line'>checking whether __attribute__ syntax is compilable... cc -O2 -Wall -DLUA_ANSI -DENABLE_CJSON_GLOBAL    -c -o strbuf.o strbuf.c
</span><span class='line'>cc -O2 -Wall -DLUA_ANSI -DENABLE_CJSON_GLOBAL    -c -o fpconv.o fpconv.c
</span><span class='line'>yes
</span><span class='line'>checking whether compiler supports -fvisibility=hidden... yes
</span><span class='line'>checking whether compiler supports -Werror... yes
</span><span class='line'>checking whether tls_model attribute is compilable... cc -O2 -Wall -DLUA_ANSI -DENABLE_CJSON_GLOBAL    -c -o lauxlib.o lauxlib.c
</span><span class='line'>cc -O2 -Wall -DLUA_ANSI -DENABLE_CJSON_GLOBAL    -c -o lbaselib.o lbaselib.c
</span><span class='line'>yes
</span><span class='line'>checking for a BSD-compatible install... /usr/bin/install -c
</span><span class='line'>checking for ranlib... ranlib
</span><span class='line'>checking for ld... /usr/bin/ld
</span><span class='line'>checking for autoconf... /usr/bin/autoconf
</span><span class='line'>checking for memalign... yes
</span><span class='line'>checking for valloc... yes
</span><span class='line'>checking configured backtracing method... N/A
</span><span class='line'>checking for sbrk... cc -O2 -Wall -DLUA_ANSI -DENABLE_CJSON_GLOBAL    -c -o ldblib.o ldblib.c
</span><span class='line'>cc -O2 -Wall -DLUA_ANSI -DENABLE_CJSON_GLOBAL    -c -o liolib.o liolib.c
</span><span class='line'>cc -O2 -Wall -DLUA_ANSI -DENABLE_CJSON_GLOBAL    -c -o lmathlib.o lmathlib.c
</span><span class='line'>yes
</span><span class='line'>checking whether utrace(2) is compilable... no
</span><span class='line'>checking whether valgrind is compilable... no
</span><span class='line'>checking STATIC_PAGE_SHIFT... cc -O2 -Wall -DLUA_ANSI -DENABLE_CJSON_GLOBAL    -c -o loslib.o loslib.c
</span><span class='line'>12
</span><span class='line'>cc -O2 -Wall -DLUA_ANSI -DENABLE_CJSON_GLOBAL    -c -o ltablib.o ltablib.c
</span><span class='line'>cc -O2 -Wall -DLUA_ANSI -DENABLE_CJSON_GLOBAL    -c -o lstrlib.o lstrlib.c
</span><span class='line'>checking pthread.h usability... cc -O2 -Wall -DLUA_ANSI -DENABLE_CJSON_GLOBAL    -c -o loadlib.o loadlib.c
</span><span class='line'>cc -O2 -Wall -DLUA_ANSI -DENABLE_CJSON_GLOBAL    -c -o linit.o linit.c
</span><span class='line'>yes
</span><span class='line'>checking pthread.h presence... yes
</span><span class='line'>checking for pthread.h... yes
</span><span class='line'>checking for pthread_create in -lpthread... cc -O2 -Wall -DLUA_ANSI -DENABLE_CJSON_GLOBAL    -c -o lua_cjson.o lua_cjson.c
</span><span class='line'>yes
</span><span class='line'>checking for _malloc_thread_cleanup... cc -O2 -Wall -DLUA_ANSI -DENABLE_CJSON_GLOBAL    -c -o lua_struct.o lua_struct.c
</span><span class='line'>no
</span><span class='line'>checking for _pthread_mutex_init_calloc_cb... no
</span><span class='line'>checking for TLS... yes
</span><span class='line'>checking whether a program using ffsl is compilable... cc -O2 -Wall -DLUA_ANSI -DENABLE_CJSON_GLOBAL    -c -o lua_cmsgpack.o lua_cmsgpack.c
</span><span class='line'>cc -O2 -Wall -DLUA_ANSI -DENABLE_CJSON_GLOBAL    -c -o lua_bit.o lua_bit.c
</span><span class='line'>yes
</span><span class='line'>checking whether atomic(9) is compilable... no
</span><span class='line'>checking whether Darwin OSAtomic*() is compilable... cc -O2 -Wall -DLUA_ANSI -DENABLE_CJSON_GLOBAL    -c -o lua.o lua.c
</span><span class='line'>cc -O2 -Wall -DLUA_ANSI -DENABLE_CJSON_GLOBAL    -c -o luac.o luac.c
</span><span class='line'>no
</span><span class='line'>checking whether to force 32-bit __sync_{add,sub}_and_fetch()... no
</span><span class='line'>checking whether to force 64-bit __sync_{add,sub}_and_fetch()... no
</span><span class='line'>checking whether Darwin OSSpin*() is compilable... no
</span><span class='line'>checking for stdbool.h that conforms to C99... cc -O2 -Wall -DLUA_ANSI -DENABLE_CJSON_GLOBAL    -c -o print.o print.c
</span><span class='line'>yes
</span><span class='line'>checking for _Bool... ar rcu liblua.a lapi.o lcode.o ldebug.o ldo.o ldump.o lfunc.o lgc.o llex.o lmem.o lobject.o lopcodes.o lparser.o lstate.o lstring.o ltable.o ltm.o lundump.o lvm.o lzio.o strbuf.o fpconv.o lauxlib.o lbaselib.o ldblib.o liolib.o lmathlib.o loslib.o ltablib.o lstrlib.o loadlib.o linit.o lua_cjson.o lua_struct.o lua_cmsgpack.o lua_bit.o        # DLL needs all object files
</span><span class='line'>ranlib liblua.a
</span><span class='line'>cc -o lua  lua.o liblua.a -lm 
</span><span class='line'>liblua.a(loslib.o): In function `os_tmpname':
</span><span class='line'>loslib.c:(.text+0x35): warning: the use of `tmpnam' is dangerous, better use `mkstemp'
</span><span class='line'>cc -o luac  luac.o print.o liblua.a -lm 
</span><span class='line'>yes
</span><span class='line'>make[4]: Leaving directory `/home/hadoop/codis/src/github.com/CodisLabs/codis/extern/redis-2.8.21/deps/lua/src'
</span><span class='line'>configure: creating ./config.status
</span><span class='line'>config.status: creating Makefile
</span><span class='line'>config.status: creating doc/html.xsl
</span><span class='line'>config.status: creating doc/manpages.xsl
</span><span class='line'>config.status: creating doc/jemalloc.xml
</span><span class='line'>config.status: creating include/jemalloc/jemalloc_macros.h
</span><span class='line'>config.status: creating include/jemalloc/jemalloc_protos.h
</span><span class='line'>config.status: creating include/jemalloc/internal/jemalloc_internal.h
</span><span class='line'>config.status: creating test/test.sh
</span><span class='line'>config.status: creating test/include/test/jemalloc_test.h
</span><span class='line'>config.status: creating config.stamp
</span><span class='line'>config.status: creating bin/jemalloc.sh
</span><span class='line'>config.status: creating include/jemalloc/jemalloc_defs.h
</span><span class='line'>config.status: creating include/jemalloc/internal/jemalloc_internal_defs.h
</span><span class='line'>config.status: creating test/include/test/jemalloc_test_defs.h
</span><span class='line'>config.status: executing include/jemalloc/internal/private_namespace.h commands
</span><span class='line'>config.status: executing include/jemalloc/internal/private_unnamespace.h commands
</span><span class='line'>config.status: executing include/jemalloc/internal/public_symbols.txt commands
</span><span class='line'>config.status: executing include/jemalloc/internal/public_namespace.h commands
</span><span class='line'>config.status: executing include/jemalloc/internal/public_unnamespace.h commands
</span><span class='line'>config.status: executing include/jemalloc/internal/size_classes.h commands
</span><span class='line'>config.status: executing include/jemalloc/jemalloc_protos_jet.h commands
</span><span class='line'>config.status: executing include/jemalloc/jemalloc_rename.h commands
</span><span class='line'>config.status: executing include/jemalloc/jemalloc_mangle.h commands
</span><span class='line'>config.status: executing include/jemalloc/jemalloc_mangle_jet.h commands
</span><span class='line'>config.status: executing include/jemalloc/jemalloc.h commands
</span><span class='line'>===============================================================================
</span><span class='line'>jemalloc version   : 3.6.0-0-g46c0af68bd248b04df75e4f92d5fb804c3d75340
</span><span class='line'>library revision   : 1
</span><span class='line'>
</span><span class='line'>CC                 : gcc
</span><span class='line'>CPPFLAGS           :  -D_GNU_SOURCE -D_REENTRANT
</span><span class='line'>CFLAGS             : -std=gnu99 -Wall -pipe -g3 -O3 -funroll-loops  -fvisibility=hidden
</span><span class='line'>LDFLAGS            : 
</span><span class='line'>EXTRA_LDFLAGS      : 
</span><span class='line'>LIBS               :  -lpthread
</span><span class='line'>RPATH_EXTRA        : 
</span><span class='line'>
</span><span class='line'>XSLTPROC           : /usr/bin/xsltproc
</span><span class='line'>XSLROOT            : 
</span><span class='line'>
</span><span class='line'>PREFIX             : /usr/local
</span><span class='line'>BINDIR             : /usr/local/bin
</span><span class='line'>INCLUDEDIR         : /usr/local/include
</span><span class='line'>LIBDIR             : /usr/local/lib
</span><span class='line'>DATADIR            : /usr/local/share
</span><span class='line'>MANDIR             : /usr/local/share/man
</span><span class='line'>
</span><span class='line'>srcroot            : 
</span><span class='line'>abs_srcroot        : /home/hadoop/codis/src/github.com/CodisLabs/codis/extern/redis-2.8.21/deps/jemalloc/
</span><span class='line'>objroot            : 
</span><span class='line'>abs_objroot        : /home/hadoop/codis/src/github.com/CodisLabs/codis/extern/redis-2.8.21/deps/jemalloc/
</span><span class='line'>
</span><span class='line'>JEMALLOC_PREFIX    : je_
</span><span class='line'>JEMALLOC_PRIVATE_NAMESPACE
</span><span class='line'>                   : je_
</span><span class='line'>install_suffix     : 
</span><span class='line'>autogen            : 0
</span><span class='line'>experimental       : 1
</span><span class='line'>cc-silence         : 1
</span><span class='line'>debug              : 0
</span><span class='line'>code-coverage      : 0
</span><span class='line'>stats              : 1
</span><span class='line'>prof               : 0
</span><span class='line'>prof-libunwind     : 0
</span><span class='line'>prof-libgcc        : 0
</span><span class='line'>prof-gcc           : 0
</span><span class='line'>tcache             : 1
</span><span class='line'>fill               : 1
</span><span class='line'>utrace             : 0
</span><span class='line'>valgrind           : 0
</span><span class='line'>xmalloc            : 0
</span><span class='line'>mremap             : 0
</span><span class='line'>munmap             : 0
</span><span class='line'>dss                : 0
</span><span class='line'>lazy_lock          : 0
</span><span class='line'>tls                : 1
</span><span class='line'>===============================================================================
</span><span class='line'>cd jemalloc && make CFLAGS="-std=gnu99 -Wall -pipe -g3 -O3 -funroll-loops " LDFLAGS="" lib/libjemalloc.a
</span><span class='line'>make[4]: Entering directory `/home/hadoop/codis/src/github.com/CodisLabs/codis/extern/redis-2.8.21/deps/jemalloc'
</span><span class='line'>gcc -std=gnu99 -Wall -pipe -g3 -O3 -funroll-loops  -c -D_GNU_SOURCE -D_REENTRANT -Iinclude -Iinclude -o src/jemalloc.o src/jemalloc.c
</span><span class='line'>gcc -std=gnu99 -Wall -pipe -g3 -O3 -funroll-loops  -c -D_GNU_SOURCE -D_REENTRANT -Iinclude -Iinclude -o src/arena.o src/arena.c
</span><span class='line'>gcc -std=gnu99 -Wall -pipe -g3 -O3 -funroll-loops  -c -D_GNU_SOURCE -D_REENTRANT -Iinclude -Iinclude -o src/atomic.o src/atomic.c
</span><span class='line'>gcc -std=gnu99 -Wall -pipe -g3 -O3 -funroll-loops  -c -D_GNU_SOURCE -D_REENTRANT -Iinclude -Iinclude -o src/base.o src/base.c
</span><span class='line'>gcc -std=gnu99 -Wall -pipe -g3 -O3 -funroll-loops  -c -D_GNU_SOURCE -D_REENTRANT -Iinclude -Iinclude -o src/bitmap.o src/bitmap.c
</span><span class='line'>gcc -std=gnu99 -Wall -pipe -g3 -O3 -funroll-loops  -c -D_GNU_SOURCE -D_REENTRANT -Iinclude -Iinclude -o src/chunk.o src/chunk.c
</span><span class='line'>gcc -std=gnu99 -Wall -pipe -g3 -O3 -funroll-loops  -c -D_GNU_SOURCE -D_REENTRANT -Iinclude -Iinclude -o src/chunk_dss.o src/chunk_dss.c
</span><span class='line'>gcc -std=gnu99 -Wall -pipe -g3 -O3 -funroll-loops  -c -D_GNU_SOURCE -D_REENTRANT -Iinclude -Iinclude -o src/chunk_mmap.o src/chunk_mmap.c
</span><span class='line'>gcc -std=gnu99 -Wall -pipe -g3 -O3 -funroll-loops  -c -D_GNU_SOURCE -D_REENTRANT -Iinclude -Iinclude -o src/ckh.o src/ckh.c
</span><span class='line'>gcc -std=gnu99 -Wall -pipe -g3 -O3 -funroll-loops  -c -D_GNU_SOURCE -D_REENTRANT -Iinclude -Iinclude -o src/ctl.o src/ctl.c
</span><span class='line'>gcc -std=gnu99 -Wall -pipe -g3 -O3 -funroll-loops  -c -D_GNU_SOURCE -D_REENTRANT -Iinclude -Iinclude -o src/extent.o src/extent.c
</span><span class='line'>gcc -std=gnu99 -Wall -pipe -g3 -O3 -funroll-loops  -c -D_GNU_SOURCE -D_REENTRANT -Iinclude -Iinclude -o src/hash.o src/hash.c
</span><span class='line'>gcc -std=gnu99 -Wall -pipe -g3 -O3 -funroll-loops  -c -D_GNU_SOURCE -D_REENTRANT -Iinclude -Iinclude -o src/huge.o src/huge.c
</span><span class='line'>gcc -std=gnu99 -Wall -pipe -g3 -O3 -funroll-loops  -c -D_GNU_SOURCE -D_REENTRANT -Iinclude -Iinclude -o src/mb.o src/mb.c
</span><span class='line'>gcc -std=gnu99 -Wall -pipe -g3 -O3 -funroll-loops  -c -D_GNU_SOURCE -D_REENTRANT -Iinclude -Iinclude -o src/mutex.o src/mutex.c
</span><span class='line'>gcc -std=gnu99 -Wall -pipe -g3 -O3 -funroll-loops  -c -D_GNU_SOURCE -D_REENTRANT -Iinclude -Iinclude -o src/prof.o src/prof.c
</span><span class='line'>gcc -std=gnu99 -Wall -pipe -g3 -O3 -funroll-loops  -c -D_GNU_SOURCE -D_REENTRANT -Iinclude -Iinclude -o src/quarantine.o src/quarantine.c
</span><span class='line'>gcc -std=gnu99 -Wall -pipe -g3 -O3 -funroll-loops  -c -D_GNU_SOURCE -D_REENTRANT -Iinclude -Iinclude -o src/rtree.o src/rtree.c
</span><span class='line'>gcc -std=gnu99 -Wall -pipe -g3 -O3 -funroll-loops  -c -D_GNU_SOURCE -D_REENTRANT -Iinclude -Iinclude -o src/stats.o src/stats.c
</span><span class='line'>gcc -std=gnu99 -Wall -pipe -g3 -O3 -funroll-loops  -c -D_GNU_SOURCE -D_REENTRANT -Iinclude -Iinclude -o src/tcache.o src/tcache.c
</span><span class='line'>gcc -std=gnu99 -Wall -pipe -g3 -O3 -funroll-loops  -c -D_GNU_SOURCE -D_REENTRANT -Iinclude -Iinclude -o src/util.o src/util.c
</span><span class='line'>gcc -std=gnu99 -Wall -pipe -g3 -O3 -funroll-loops  -c -D_GNU_SOURCE -D_REENTRANT -Iinclude -Iinclude -o src/tsd.o src/tsd.c
</span><span class='line'>ar crus lib/libjemalloc.a src/jemalloc.o src/arena.o src/atomic.o src/base.o src/bitmap.o src/chunk.o src/chunk_dss.o src/chunk_mmap.o src/ckh.o src/ctl.o src/extent.o src/hash.o src/huge.o src/mb.o src/mutex.o src/prof.o src/quarantine.o src/rtree.o src/stats.o src/tcache.o src/util.o src/tsd.o
</span><span class='line'>make[4]: Leaving directory `/home/hadoop/codis/src/github.com/CodisLabs/codis/extern/redis-2.8.21/deps/jemalloc'
</span><span class='line'>make[3]: Leaving directory `/home/hadoop/codis/src/github.com/CodisLabs/codis/extern/redis-2.8.21/deps'
</span><span class='line'>    CC adlist.o
</span><span class='line'>    CC ae.o
</span><span class='line'>    CC anet.o
</span><span class='line'>    CC dict.o
</span><span class='line'>anet.c: In function ‘anetSockName’:
</span><span class='line'>anet.c:565: warning: dereferencing pointer ‘s’ does break strict-aliasing rules
</span><span class='line'>anet.c:563: note: initialized from here
</span><span class='line'>anet.c:569: warning: dereferencing pointer ‘s’ does break strict-aliasing rules
</span><span class='line'>anet.c:567: note: initialized from here
</span><span class='line'>anet.c: In function ‘anetPeerToString’:
</span><span class='line'>anet.c:543: warning: dereferencing pointer ‘s’ does break strict-aliasing rules
</span><span class='line'>anet.c:541: note: initialized from here
</span><span class='line'>anet.c:547: warning: dereferencing pointer ‘s’ does break strict-aliasing rules
</span><span class='line'>anet.c:545: note: initialized from here
</span><span class='line'>anet.c: In function ‘anetTcpAccept’:
</span><span class='line'>anet.c:511: warning: dereferencing pointer ‘s’ does break strict-aliasing rules
</span><span class='line'>anet.c:509: note: initialized from here
</span><span class='line'>anet.c:515: warning: dereferencing pointer ‘s’ does break strict-aliasing rules
</span><span class='line'>anet.c:513: note: initialized from here
</span><span class='line'>    CC redis.o
</span><span class='line'>    CC sds.o
</span><span class='line'>    CC zmalloc.o
</span><span class='line'>    CC lzf_c.o
</span><span class='line'>    CC lzf_d.o
</span><span class='line'>    CC pqsort.o
</span><span class='line'>    CC zipmap.o
</span><span class='line'>    CC ziplist.o
</span><span class='line'>    CC sha1.o
</span><span class='line'>    CC release.o
</span><span class='line'>    CC networking.o
</span><span class='line'>    CC util.o
</span><span class='line'>    CC object.o
</span><span class='line'>    CC db.o
</span><span class='line'>    CC replication.o
</span><span class='line'>    CC rdb.o
</span><span class='line'>db.c: In function ‘scanGenericCommand’:
</span><span class='line'>db.c:454: warning: ‘pat’ may be used uninitialized in this function
</span><span class='line'>db.c:455: warning: ‘patlen’ may be used uninitialized in this function
</span><span class='line'>    CC t_string.o
</span><span class='line'>    CC t_list.o
</span><span class='line'>    CC t_set.o
</span><span class='line'>    CC t_zset.o
</span><span class='line'>    CC t_hash.o
</span><span class='line'>    CC config.o
</span><span class='line'>    CC aof.o
</span><span class='line'>    CC pubsub.o
</span><span class='line'>    CC multi.o
</span><span class='line'>    CC debug.o
</span><span class='line'>    CC sort.o
</span><span class='line'>    CC intset.o
</span><span class='line'>    CC syncio.o
</span><span class='line'>    CC migrate.o
</span><span class='line'>    CC endianconv.o
</span><span class='line'>    CC slowlog.o
</span><span class='line'>    CC scripting.o
</span><span class='line'>    CC bio.o
</span><span class='line'>    CC rio.o
</span><span class='line'>    CC rand.o
</span><span class='line'>    CC memtest.o
</span><span class='line'>    CC crc64.o
</span><span class='line'>    CC crc32.o
</span><span class='line'>    CC bitops.o
</span><span class='line'>    CC sentinel.o
</span><span class='line'>    CC notify.o
</span><span class='line'>    CC setproctitle.o
</span><span class='line'>    CC hyperloglog.o
</span><span class='line'>    CC latency.o
</span><span class='line'>    CC sparkline.o
</span><span class='line'>    CC slots.o
</span><span class='line'>    CC redis-cli.o
</span><span class='line'>    CC redis-benchmark.o
</span><span class='line'>    CC redis-check-dump.o
</span><span class='line'>    CC redis-check-aof.o
</span><span class='line'>    LINK redis-benchmark
</span><span class='line'>    LINK redis-check-dump
</span><span class='line'>    LINK redis-check-aof
</span><span class='line'>    LINK redis-server
</span><span class='line'>    INSTALL redis-sentinel
</span><span class='line'>    LINK redis-cli
</span><span class='line'>
</span><span class='line'>Hint: It's a good idea to run 'make test' ;)
</span><span class='line'>
</span><span class='line'>make[2]: Leaving directory `/home/hadoop/codis/src/github.com/CodisLabs/codis/extern/redis-2.8.21/src'
</span><span class='line'>make[1]: Leaving directory `/home/hadoop/codis/src/github.com/CodisLabs/codis/extern/redis-2.8.21'
</span><span class='line'>[hadoop@cu2 codis]$ </span></code></pre></td></tr></table></div></figure>


<p>简单使用：</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
<span class='line-number'>48</span>
<span class='line-number'>49</span>
<span class='line-number'>50</span>
<span class='line-number'>51</span>
<span class='line-number'>52</span>
<span class='line-number'>53</span>
<span class='line-number'>54</span>
<span class='line-number'>55</span>
<span class='line-number'>56</span>
<span class='line-number'>57</span>
<span class='line-number'>58</span>
<span class='line-number'>59</span>
<span class='line-number'>60</span>
<span class='line-number'>61</span>
<span class='line-number'>62</span>
<span class='line-number'>63</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>[hadoop@cu2 codis]$ pwd
</span><span class='line'>/home/hadoop/codis/src/github.com/CodisLabs/codis
</span><span class='line'>[hadoop@cu2 codis]$ ll bin
</span><span class='line'>total 39856
</span><span class='line'>drwxrwxr-x 4 hadoop hadoop     4096 Jul 14 15:49 assets
</span><span class='line'>-rwxrwxr-x 1 hadoop hadoop 17329904 Jul 14 15:49 codis-config
</span><span class='line'>-rwxrwxr-x 1 hadoop hadoop 17151864 Jul 14 15:49 codis-proxy
</span><span class='line'>-rwxrwxr-x 1 hadoop hadoop  6313083 Jul 14 15:49 codis-server
</span><span class='line'>
</span><span class='line'>&lt;&lt;配置
</span><span class='line'>[hadoop@cu2 codis]$ vi config.ini 
</span><span class='line'>zk=cu3:2181
</span><span class='line'>dashboard_addr=cu2:18087
</span><span class='line'>session_max_timeout=0
</span><span class='line'>session_max_bufsize=1310720
</span><span class='line'>session_max_pipeline=10240000
</span><span class='line'>
</span><span class='line'>&lt;&lt;启动dashboard（大部分命令其实都可以通过网页来完成）
</span><span class='line'>[hadoop@cu2 codis]$ nohup bin/codis-config dashboard &gt;log/dashboard.log 2&gt;&1 &
</span><span class='line'>
</span><span class='line'>&lt;&lt;初始化1024 slot
</span><span class='line'>[hadoop@cu2 codis]$ bin/codis-config slot init
</span><span class='line'>{
</span><span class='line'>  "msg": "OK",
</span><span class='line'>  "ret": 0
</span><span class='line'>}
</span><span class='line'>
</span><span class='line'>&lt;&lt;启动redis server
</span><span class='line'>[hadoop@cu2 codis]$ bin/codis-server --port 16379 --daemonize yes
</span><span class='line'>
</span><span class='line'>&lt;&lt;在网页上分配好slot，或者：
</span><span class='line'>
</span><span class='line'>$ bin/codis-config slot range-set 0 511 1 online
</span><span class='line'>$ bin/codis-config slot range-set 512 1023 2 online
</span><span class='line'>
</span><span class='line'>&lt;&lt;然后启动proxy
</span><span class='line'>[hadoop@hadoop-master1 codis]$ nohup bin/codis-proxy -c config.ini -L proxy.log  --cpu=64 --addr=0.0.0.0:6372 --http-addr=0.0.0.0:11000 &gt;&gt;proxy.log 2&gt;&1 &
</span><span class='line'>
</span><span class='line'>&lt;&lt;客户端连接proxy
</span><span class='line'>[hadoop@cu2 codis]$ ~/redis/bin/redis-cli -p 19000
</span><span class='line'>&lt;&lt;不支持的命令
</span><span class='line'>127.0.0.1:19000&gt; keys *
</span><span class='line'>Error: Server closed the connection
</span><span class='line'>127.0.0.1:19000&gt; scan 0
</span><span class='line'>Error: Server closed the connection
</span><span class='line'>
</span><span class='line'>127.0.0.1:19000&gt; get a
</span><span class='line'>"b"
</span><span class='line'>
</span><span class='line'>127.0.0.1:19000&gt; select 2
</span><span class='line'>(error) ERR invalid DB index, only accept DB 0
</span><span class='line'>
</span><span class='line'>&lt;&lt;也可以单独连接到redis server，进行操作
</span><span class='line'>[hadoop@cu2 codis]$ ~/redis/bin/redis-cli -p 16378
</span><span class='line'># Keyspace
</span><span class='line'>db0:keys=6,expires=0,avg_ttl=0
</span><span class='line'>127.0.0.1:16378&gt; keys *
</span><span class='line'>1) "7"
</span><span class='line'>2) "1"
</span><span class='line'>3) "2"
</span><span class='line'>4) "4"
</span><span class='line'>5) "5"
</span><span class='line'>6) "a"</span></code></pre></td></tr></table></div></figure>


<p><a href="https://github.com/CodisLabs/codis/blob/master/doc/unsupported_cmds.md">codis不支持的命令</a>，基本上都是全局操作的命令。不影响使用，如果一定要使用，可以通过客户端单独连server执行。</p>

<p>有个疑问，怎么查看proxy写的数据放在那个slot？要学学go才行。</p>

<h2>安装参考</h2>

<ul>
<li><a href="https://lvs071103.gitbooks.io/codis/content/install.html">https://lvs071103.gitbooks.io/codis/content/install.html</a></li>
<li><a href="http://jicki.blog.51cto.com/1323993/1748549">http://jicki.blog.51cto.com/1323993/1748549</a></li>
</ul>


<p>&ndash;END</p>
</div>


  <footer>
    <p class="meta">
      
  

<span class="byline author vcard">Posted by <span class="fn">Winse Liu</span></span>

      








  


<time datetime="2016-07-14T19:35:23+08:00" pubdate data-updated="true">Thu 2016-07-14 19:35</time>
      

<span class="categories">
  
    <a class='category' href='/blog/categories/redis/'>redis</a>
  
</span>


	  <span style="padding: 0 1em;">
<a class="shellExecuteLink" href="npp-windows://e/_posts/2016-07-14-codis-guide.markdown" title="本地编辑"><i class="icon-edit"> </i>编辑</a>
</span>	
    </p>
    
      <div class="sharing">
  
  
  
</div>

    
    <p class="meta">
      
        <a class="basic-alignment left" href="/blog/2016/06/28/flume-kafka-elasticsearch-for-analyse/" title="Previous Post: 使用 flume+kafka+elasticsearch 处理数据">&laquo; 使用 flume+kafka+elasticsearch 处理数据</a>
      
      
        <a class="basic-alignment right" href="/blog/2016/07/19/xss-blocked-by-naxsi/" title="Next Post: 使用 naxsi 处理 XSS">使用 naxsi 处理 XSS &raquo;</a>
      
    </p>
  </footer>
</article>

  <section>
    <h1>Comments</h1>
    <div id="disqus_thread" aria-live="polite"><noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</div>
  </section>

</div>

<aside class="sidebar">
  
    <section>
  <h1>佛爷</h1>
  <p>来之不易, 且等且珍惜. <br>得之我幸; 不得<span style="display:none">-争-复争-且不得</span>, 命也, 乐享天命, 福也. </p>
  <p><a href="https://github.com/winse"><i class="fa fa-github-alt">winse</i></a>&nbsp;&nbsp;<a href="http://weibo.com/winseliu"><i class="fa fa-weibo">winseliu</i></a></p>
</section>
<section>
  <h1><a class='category' href='/blog/categories/recommend/'>Recommend</a></h1>
	<ul role="list">
		
			<li class="post">
				<a href="/blog/2016/04/23/hadoop-guide-catalog/">[整理] Hadoop入门</a>
			</li>
		
			<li class="post">
				<a href="/blog/2016/03/28/hive-on-spark/">Hive on Spark</a>
			</li>
		
			<li class="post">
				<a href="/blog/2016/01/23/install-and-config-ganglia-on-redhat-2/">安装配置Ganglia(2)</a>
			</li>
		
			<li class="post">
				<a href="/blog/2015/08/24/manual-install-supervisor/">Supervisor安装配置</a>
			</li>
		
			<li class="post">
				<a href="/blog/2014/10/16/spark-build-and-configuration/">编译/搭建Spark环境</a>
			</li>
		
			<li class="post">
				<a href="/blog/2014/08/25/step-by-step-found-java-oom-error/">查找逐步定位Java程序OOM的异常实践</a>
			</li>
		
			<li class="post">
				<a href="/blog/2014/07/30/hadoop2-snappy-compress/">Hadoop2 Snappy Compress</a>
			</li>
		
			<li class="post">
				<a href="/blog/2014/07/27/start-redis/">[读读书]Redis入门指南</a>
			</li>
		
			<li class="post">
				<a href="/blog/2014/04/21/hadoop2-windows-startguide/">Windows下部署/配置/调试hadoop2</a>
			</li>
		
			<li class="post">
				<a href="/blog/2014/03/30/git-cheatsheet/">GIT操作记录手册</a>
			</li>
		
			<li class="post">
				<a href="/blog/2014/03/18/jekyll-edit-link-in-web-page/">Jekyll页面添加编辑按钮</a>
			</li>
		
			<li class="post">
				<a href="/blog/2013/09/19/let-shell-command-efficient/">让敲Shell命令高效起来</a>
			</li>
		
	</ul>
</section>
<section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/blog/2016/12/01/jasperreports-brief-summary/">Jasperreports使用小结</a>
      </li>
    
      <li class="post">
        <a href="/blog/2016/11/10/play2-development-environment-with-eclipse/">Play2开发环境搭建</a>
      </li>
    
      <li class="post">
        <a href="/blog/2016/10/20/ssh-upgrade-on-centos6/">红帽6升级SSH</a>
      </li>
    
      <li class="post">
        <a href="/blog/2016/10/12/sparksql-view-and-debug-generatecode/">SparkSQL查看调试生成代码</a>
      </li>
    
      <li class="post">
        <a href="/blog/2016/10/12/maven-create-ourself-archetype/">Maven创建自己的Archetype</a>
      </li>
    
      <li class="post">
        <a href="/blog/2016/09/19/163-open-movies-download/">批量下载163-open的视频</a>
      </li>
    
      <li class="post">
        <a href="/blog/2016/09/12/zookeeper-switch-node/">Zookeeper节点切换</a>
      </li>
    
      <li class="post">
        <a href="/blog/2016/09/06/puppet-modify-password/">Puppet批量修改用户密码</a>
      </li>
    
  </ul>
</section>
<section>
  <h1>Categories</h1>

	 
	<ul role="list">
		
		 
		<li style="float:left; width:120px"> 
			<a class='category' href='/blog/categories/alluxio/'>alluxio</a> (1) 
		</li>
		 
		<li style="float:left; width:120px"> 
			<a class='category' href='/blog/categories/android/'>android</a> (1) 
		</li>
		 
		<li style="float:left; width:120px"> 
			<a class='category' href='/blog/categories/bigdata/'>bigdata</a> (1) 
		</li>
		 
		<li style="float:left; width:120px"> 
			<a class='category' href='/blog/categories/blabla/'>blabla</a> (4) 
		</li>
		 
		<li style="float:left; width:120px"> 
			<a class='category' href='/blog/categories/books/'>books</a> (6) 
		</li>
		 
		<li style="float:left; width:120px"> 
			<a class='category' href='/blog/categories/debug/'>debug</a> (1) 
		</li>
		 
		<li style="float:left; width:120px"> 
			<a class='category' href='/blog/categories/docker/'>docker</a> (4) 
		</li>
		 
		<li style="float:left; width:120px"> 
			<a class='category' href='/blog/categories/elasticsearch/'>elasticsearch</a> (2) 
		</li>
		 
		<li style="float:left; width:120px"> 
			<a class='category' href='/blog/categories/flume/'>flume</a> (1) 
		</li>
		 
		<li style="float:left; width:120px"> 
			<a class='category' href='/blog/categories/ganglia/'>ganglia</a> (5) 
		</li>
		 
		<li style="float:left; width:120px"> 
			<a class='category' href='/blog/categories/git/'>git</a> (3) 
		</li>
		 
		<li style="float:left; width:120px"> 
			<a class='category' href='/blog/categories/hadoop/'>hadoop</a> (42) 
		</li>
		 
		<li style="float:left; width:120px"> 
			<a class='category' href='/blog/categories/hbase/'>hbase</a> (1) 
		</li>
		 
		<li style="float:left; width:120px"> 
			<a class='category' href='/blog/categories/hive/'>hive</a> (7) 
		</li>
		 
		<li style="float:left; width:120px"> 
			<a class='category' href='/blog/categories/hole/'>hole</a> (1) 
		</li>
		 
		<li style="float:left; width:120px"> 
			<a class='category' href='/blog/categories/java/'>java</a> (9) 
		</li>
		 
		<li style="float:left; width:120px"> 
			<a class='category' href='/blog/categories/jekyll/'>jekyll</a> (7) 
		</li>
		 
		<li style="float:left; width:120px"> 
			<a class='category' href='/blog/categories/kafka/'>kafka</a> (2) 
		</li>
		 
		<li style="float:left; width:120px"> 
			<a class='category' href='/blog/categories/nginx/'>nginx</a> (1) 
		</li>
		 
		<li style="float:left; width:120px"> 
			<a class='category' href='/blog/categories/puppet/'>puppet</a> (10) 
		</li>
		 
		<li style="float:left; width:120px"> 
			<a class='category' href='/blog/categories/recommend/'>recommend</a> (12) 
		</li>
		 
		<li style="float:left; width:120px"> 
			<a class='category' href='/blog/categories/redis/'>redis</a> (6) 
		</li>
		 
		<li style="float:left; width:120px"> 
			<a class='category' href='/blog/categories/scala/'>scala</a> (4) 
		</li>
		 
		<li style="float:left; width:120px"> 
			<a class='category' href='/blog/categories/shell/'>shell</a> (4) 
		</li>
		 
		<li style="float:left; width:120px"> 
			<a class='category' href='/blog/categories/spark/'>spark</a> (10) 
		</li>
		 
		<li style="float:left; width:120px"> 
			<a class='category' href='/blog/categories/tachyon/'>tachyon</a> (3) 
		</li>
		 
		<li style="float:left; width:120px"> 
			<a class='category' href='/blog/categories/tez/'>tez</a> (2) 
		</li>
		 
		<li style="float:left; width:120px"> 
			<a class='category' href='/blog/categories/tools/'>tools</a> (40) 
		</li>
		 
		<li style="float:left; width:120px"> 
			<a class='category' href='/blog/categories/topics/'>topics</a> (2) 
		</li>
		 
		<li style="float:left; width:120px"> 
			<a class='category' href='/blog/categories/zookeeper/'>zookeeper</a> (1) 
		</li>
		
		
		<li style="clear:both; width: 1px; margin: 0; padding: 0;"></li>
		<li class="category"><a href="/blog/archives">All categories</a> (152)</li>
	</ul>
	
</section>

<section>
  <h1>GitHub Repos</h1>
  <ul id="gh_repos">
    <li class="loading">Status updating...</li>
  </ul>
  
  <a href="https://github.com/winse">@winse</a> on GitHub
  
  <script type="text/javascript">
    $(document).ready(function(){
        if (!window.jXHR){
            var jxhr = document.createElement('script');
            jxhr.type = 'text/javascript';
            jxhr.src = '/javascripts/libs/jXHR.js';
            var s = document.getElementsByTagName('script')[0];
            s.parentNode.insertBefore(jxhr, s);
        }

        github.showRepos({
            user: 'winse',
            count: 4,
            skip_forks: true,
            target: '#gh_repos'
        });
    });
  </script>
  <script src="/javascripts/github.js" type="text/javascript"> </script>
</section>

<section>
  <h1>Softs, I'm using</h1>
  <ul>
    <li class="post">
		<a href="http://hadoop.apache.org/releases.html">hadoop-2.6.3</a>
	</li>
	<li class="post">
		<a href="https://issues.apache.org/jira/browse/HBASE/?selectedTab=com.atlassian.jira.jira-projects-plugin:changelog-panel">hbase-0.96.0</a>
	</li>
	<li class="post">
		<a href="https://hive.apache.org/downloads.html">hive-1.2.1</a>
	</li>
	<li class="post">
		<a href="https://issues.apache.org/jira/browse/TEZ/?selectedTab=com.atlassian.jira.jira-projects-plugin:summary-panel">tez-0.7.0</a>
    </li>
  </ul>
</section>

  
</aside>


    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2016 - Winse Liu -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
  <script type="text/javascript">var cnzz_protocol = (("https:" == document.location.protocol) ? " https://" : " http://");document.write(unescape("%3Cspan id='cnzz_stat_icon_1253461959'%3E%3C/span%3E%3Cscript src='" + cnzz_protocol + "v1.cnzz.com/z_stat.php%3Fid%3D1253461959%26show%3Dpic' type='text/javascript'%3E%3C/script%3E"));</script>
</p>

</footer>
  

<script type="text/javascript">
      var disqus_shortname = 'winseliu';
      
        
        // var disqus_developer = 1;
        var disqus_identifier = 'http://winseliu.com/blog/2016/07/14/codis-guide/';
        var disqus_url = 'http://winseliu.com/blog/2016/07/14/codis-guide/';
        var disqus_script = 'embed.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = '//' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>











</body>
</html>
