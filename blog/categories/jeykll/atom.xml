<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">

  <title><![CDATA[Category: Jeykll | Winse Blog]]></title>
  <link href="http://winse.github.io/blog/categories/jeykll/atom.xml" rel="self"/>
  <link href="http://winse.github.io/"/>
  <updated>2022-04-14T02:59:06+08:00</updated>
  <id>http://winse.github.io/</id>
  <author>
    <name><![CDATA[Winse Liu]]></name>
    <email><![CDATA[winseliu@foxmail.com]]></email>
  </author>
  <generator uri="http://octopress.org/">Octopress</generator>

  
  <entry>
    <title type="html"><![CDATA[octopress生成TOC]]></title>
    <link href="http://winse.github.io/blog/2021/12/08/octopress-generate-toc/"/>
    <updated>2021-12-08T18:23:23+08:00</updated>
    <id>http://winse.github.io/blog/2021/12/08/octopress-generate-toc</id>
    <content type="html"><![CDATA[<p>尝试了jekyll直接生成toc的方式都失败了，最终通过jquery运行时生成的方式实现目录导航。</p>

<h2>参考</h2>

<ul>
<li><a href="http://brizzled.clapper.org/blog/2012/02/04/generating-a-table-of-contents-in-octopress/">Generating a Table of Contents in Octopress</a></li>
</ul>


<h2>步骤实现</h2>

<h3>添加jquery.toc.min.js</h3>

<p>1、下载 <a href="https://ndabas.github.io/toc/">https://ndabas.github.io/toc/</a> 当前是 0.4.0 版本。解压把 jquery.toc.min.js 放到 source/javascripts/libs/ 目录下。</p>

<p>2、在 source/_includes/head.html 文件的 jquery.min.js 下一行引入 jquery.toc.min.js ：</p>

<pre><code>
  &lt;script&gt;!window.jQuery &amp;&amp; document.write(unescape('%3Cscript src="{{ root_url }}/javascripts/libs/jquery.min.js"%3E%3C/script%3E'))&lt;/script&gt;
  &lt;script src="{{ root_url }}/javascripts/libs/jquery.toc.min.js" type="text/javascript"&gt;&lt;/script&gt;

</code></pre>

<h3>使用toc创建目录导航</h3>

<p>3、在 source/javascripts 目录下创建 generate-toc.js ，内容如下：</p>

<pre><code>function generateTOC(insertBefore, heading) {
  var container = jQuery("&lt;div id='tocBlock'&gt;&lt;/div&gt;");
  var div = jQuery("&lt;ul id='toc'&gt;&lt;/ul&gt;");

  var content = $(insertBefore).first();

  if (heading != undefined &amp;&amp; heading != null) {
    container.append('&lt;span class="tocHeading"&gt;' + heading + '&lt;/span&gt;');
  }

// div.tableOfContents(content);
  div.toc({content: content, headings: "h2,h3,h4"});
  container.append(div);
  container.insertBefore(insertBefore);
}
</code></pre>

<p>并在 source/_includes/custom/head.html 引入该文件：</p>

<p>```
</p>

<script src="{{ root_url }}/javascripts/generate-toc.js" type="text/javascript"></script>


<p>
```</p>

<p>4、运行时调用toc创建目录，在 source/_includes/custom/after_footer.html 添加如下内容：</p>

<pre><code>
{% if index %}
  {% comment %}
  No table of contents on the index page.
  {% endcomment %}

{% elsif page.toc == true %}
  &lt;script type="text/javascript"&gt;
  jQuery(document).ready(function() {
    // Put a TOC right before the entry content.
    generateTOC('.entry-content', '目录');
  });
  &lt;/script&gt;
{% endif %}

</code></pre>

<h3>CSS样式</h3>

<p>5、添加样式，在 sass/custom 目录下添加 _screen.scss 文件，内容如下：</p>

<pre><code>$toc-bg: #dfdfdf;

$toc-incr: 5px;

div#tocBlock {
border-radius: 10px;
padding: 10px;
box-shadow: 5px 5px 5px #999;

    float: right;
    font-size: 10pt;
    width: 300px;
    padding-left: 20px;
    padding-right: 10px;
    padding-top: 10px;
    padding-bottom: 0px;

    background: $toc-bg;
    border: solid 1px #999999;
    margin: 0 0 10px 15px;

    .tocHeading {
        font-weight: bold;
        font-size: 125%;
    }

    #toc {
        background: $toc-bg;
        ul {
            list-style: disc;
            li {
                margin-left: $toc-incr !important;
                padding: 0 !important;
            }
        }
    }
}
</code></pre>

<p>并把该文件添加到 sass/screen.scss ：</p>

<pre><code>@import "custom/screen";
</code></pre>

<h3>运行调试</h3>

<p>6、删除 source/stylesheets/screen.css</p>

<p>7、预览看效果 <code>rake preview</code></p>

<h2>jekyll生成 查看</h2>

<blockquote><p>{:toc} ，jekyll-toc ，jekyll html 都没试成功，难道是jekyll-2太老了？</p></blockquote>

<ul>
<li><a href="https://plutotree.me/jekyll/2019/01/30/jekyll-toc-solution.html">https://plutotree.me/jekyll/2019/01/30/jekyll-toc-solution.html</a></li>
<li><a href="http://www.zhengjiachao.com/topics/github.io/add-outline-on-jekyll-post.html">http://www.zhengjiachao.com/topics/github.io/add-outline-on-jekyll-post.html</a></li>
<li><a href="https://github.com/allejo/jekyll-toc#usage">https://github.com/allejo/jekyll-toc#usage</a></li>
</ul>


<p>&ndash;END</p>
]]></content>
  </entry>
  
</feed>
